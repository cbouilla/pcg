#include <assert.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <math.h>
#include <sys/time.h>

#include "fonctions.h"


unsigned long long Greduite2[30 * 30] = {
78807003835510, -447595239417113, 312111512344, 1129547539316913, 479176602328474, -629991593881717, -530359659368363, 152559130975530, 195775407053119, 161860235391065, 551934126069237, 305366769687666, -30927758421033, -523676756340043, 9052246851, -515403559426818, -95893374893218, 554077770869942, -680335011105114, 994792147082620, 1128457689192807, 1029935891205613, -659966816583722, 478021373504369, 891353214957720, -879169328104962, -644295727296797, 597485129499097, -510735134294982, -682907648292500, 
1373983629205454, 945255734475331, -1848150460301960, 541994682598837, -593745025796478, -41020614737289, -125872324872983, 1641389420001362, -40782293362693, 1187246978420221, -220302689085175, -982170266011974, 974806407443187, 5420442253513, -1049650685357297, -647172521685898, 19869934894166, 770955580780814, -247617080148290, -767394813355412, 1496650323202755, 441903386476257, 788502449690798, -50528125596811, 630255984070904, -810191848098442, 2181153117070639, -1326355929758339, 173611286640546, -840332052016612, 
-111599552903546, 79368158139919, -843829835128488, -825005410928695, 553606761078026, 317754606978067, -715715624376115, 758787415407130, 910364800297127, -546727915642063, -517834837875347, 51159991172130, -1624882776769153, -390954462202835, -122666693997301, -510317866827826, 1011530814449454, 581285082705094, 569394679708982, 770646225659676, -1419944234946417, -54729985415003, 2215852736568038, -147587352083319, -708347770690856, -1197037948416818, 895425032777643, 1784122489018545, 868884254304938, -1038185704027764, 
626761888187934, -402949874869237, -1619299381506888, 173425432538925, -144879987904590, 1556244822154015, -202143826330303, 282055964517634, -593671229608189, 113809151038005, 798375681872993, 38650877337898, -720625538867909, 1326637246664225, 1308344682042871, -1372663789902202, -687308497517722, 1290705396847966, 74567715660686, 1174163936146060, 797900201902219, -454377489661319, -378804656143362, -2275466373226771, -272580512254920, 65920983345030, -1467679249503465, 822065349541301, 283069250984914, 68939977562812, 
-730717669574122, -1136581941878537, -291312718660200, -963752811891423, 599570269005562, 1617785382033755, -1489900897011579, -367798834616950, 216212261260751, 311823619905097, -866548264078299, -792665205470126, -373043467332889, 869147648836837, -171138313714285, 1284129251337758, 1378520944242302, 1057347371226710, 1449506052770118, 1267978563446716, -667772392933513, -770263510060899, -252339035887754, -1023301774470175, -151145175342312, -172508457800930, -919846488836301, -260774420508727, -4653780759654, -689894778905428, 
317423125679086, -753298203951981, 607600239258104, 968385816020965, 933279639829858, -700774603552889, -1578065770296871, 520827982690866, 281546039812811, -158233209083987, 28706626493433, -627479583351270, -431750175337917, -654490798252103, -62945276640609, 997684860033558, -299826681160714, -117575372969682, -850271964773410, -1258856833245780, 57852536458515, -358285195724719, 26649882068686, 1094029413945765, 603887875917176, 1121694174688022, -559875942145345, -1408521925433555, 1041443575700610, -74982423051684, 
399034429811494, 1803956615386527, -897372190105640, -2220355437662535, -1057811626854550, 50782237999459, -659608803054211, 619710004542330, 1553397050258103, 846627851841441, -1166145750822883, -2643996237915902, -169075682898417, -1493092821740835, 259570589220571, 234173269158894, 972364598586702, -314355681784474, 1070325210226390, -1447756381894820, -771229631625185, -1798666669063211, 1274985045346694, 899974750195577, 603181877217624, 1225461003774190, -43828383815813, 347401522810145, 67294511143690, -1779946193073460, 
-926564850129602, 268937006718427, 150371112887608, 923156938104285, -1350525984732270, -916252244426321, 1079804043567281, 75989239088098, -875973469960877, 736851490049125, 286272965850577, 1200118599002506, 776546245751819, 652657023300497, 1170264061436679, -960818744620250, 1099362655578630, -238393557475202, 1223490735764398, -652049230191668, 719496459926107, 820272563664489, 1558506230322462, -34013155413603, -1113942165367624, -790374867305434, 513300036064807, -125689703710747, -445738051738190, 794156397572348, 
44110274010550, 895275080023559, 932925355087896, -898477258413423, -179505248146854, -68043281670613, 1102237373195701, -1544312535418902, -1171442882924193, -692471768193735, -369621773232299, -552243542241742, 423147924461815, -646329035277291, -1646061310055709, -775961133185730, -603310010165346, 612618771125750, -61587070983706, 471543986105852, -166670560383865, -951231480328115, 176943033582870, -472529439670959, 72972222604696, -172944065234370, 1183689982833283, -208818288146759, -576597593983750, 297251365477356, 
-1262575995230706, 437280083358179, -94348908507528, -1405485048918251, -901510097295806, 195160026526615, 1777351721572297, 1289194078350866, 307197204699291, 233772423122525, -1936121118050327, -797271849656454, 323016333956243, 1465301310889897, 210780834394415, -2333047023272522, 1615590590886294, -153332733341874, 1028730459907838, -260685802238740, -1038901004354973, 824276846273217, 677827797844718, -360724135519019, -353153076547080, 836246695773878, 2318716663217999, -32678440905251, -438318648605854, -836774088044900, 
-1279255739238970, -911982176857041, -259249580476840, 961066307305129, -873325434291254, 132322485273011, 1064994315947821, -1076329917729062, -1164898071571513, 1230050101706001, 1231825914099661, 1231897228097506, 12377324277151, 408095296564877, -223674990875733, -596184825641458, -543891237961362, -1161661251808250, 528537350264438, 1400760437457820, -515586432803153, -1223672851196923, 596561344429606, -1439047805586583, -274720607189032, -1337070371491058, 1051717365168715, 1406976359957137, 737286581572970, 559350877607948, 
-1358905038896546, 299867637750443, 1231828519417272, -54232489834099, 1315395991452018, -1339920011659457, 730537368491297, -724731249441598, 469460166315683, -379965428151403, 480886095464513, 527909911542762, -242659856501285, 175748936731137, -763669306435817, -1643818629245498, 841298506094246, -1526724964013666, -864232866074162, 1009093863809292, -810184827752661, 890107119285081, 142124628280382, -1146369290387123, -1696205862703816, -145077578320186, 511689974679607, 1089447577421589, -492793571614318, -1753708038438084, 
-554427271579818, -587653887131113, -313123414537576, -825271994920703, -565093613566022, 1207382173265403, 327282905802725, -1548892030864310, 460483374584815, -621686991614679, -75148721295483, 184243424264722, 1913709592344071, -350423705507771, -548720211143885, -598764566977954, -748573308707138, 651017780759446, 879340715958406, 1404360400990268, 778959297284247, 152838803643645, 1036978703710390, 1415524080654273, 957751393992728, 1204874196649822, 1545648366948563, 118436062598825, -83455592916902, 482908039137068, 
-709187995644370, 286070289672755, 1002500037012216, -264787238401211, -174568297410270, 227272436553383, 93195620912825, 569540871877618, 804608122718571, 28746146443789, -2378593886741287, 445043745544922, -5452001539613, -1628514276595559, -1333386568864065, -9563542726826, 761425112161590, -52932760321170, 991312749742110, 244453020657708, -454716357940557, 438971617062449, 40787684633870, -139754703987451, -1686881546578312, 2234219117006934, 762429334047455, 708935015924109, -784182591976382, -189111779526948, 
-319798362782106, 930786622005695, 1029364281812184, -334632703420519, -135692772767190, -1038181502053117, -229609585328675, 96661655505978, -686685433898025, 1096510778227585, -65791081837443, -10992011675454, -1553599461897169, -938813964552387, -254471637703813, 258158460448302, -763401771154546, 635703000260774, 1593309563929622, -1269994869367844, -1801808591371201, -310154818189003, -372853782112058, 466601820741721, 704855551090264, -961000521610450, 608468899035163, -909344156620543, 382474351229386, -306563859353268, 
43895049059710, -611796737138053, -53483625513416, 1477050020422205, -1258737400145582, -111585980576817, -305020735878511, -93758907627614, -2083773046924557, 1537445360140229, -503705840419919, -458785906821046, 708952505234091, 1944799969558897, 1482010228589095, 325152979756646, 891139018156358, 152080221245630, -1278454852583954, 1341070785227340, 126665747590907, -772901890037431, 331208270442846, -616825518031363, 740139221663160, -2012505975031962, 434669081809223, -1004967540178107, 565020287217522, 1393601002803580, 
741102825432822, 178424692423975, -175745357228776, 1205845170133105, -475349277106406, 954867877419211, -1150595506917611, 491739336178346, -1213329813371521, 1638582618340889, -623383660958539, -762730419582990, -1036728612652521, -117256386758283, -82770698531197, -331582678278786, 81604645528542, -902326081185994, 120465201472806, 271668131655292, -156953471312985, -23200141408595, 531743157051990, -595000941833423, 644425884856984, 254269450203774, -831881535348189, -434400947212391, -1041564974918214, 1609169560460908, 
-460999795366834, 865529815692675, 683563427626872, -674763640394635, -183747190530558, -548724169129801, 1281752954592937, 480676880870354, -697558280043205, -683210349919555, 702028115557065, -650864278327238, 443231117967923, 1711139718818441, 898056296745807, -1589238104373514, 2375251368574678, 926011424744846, -95276243548354, -434624494669972, -808409309352445, 714043049904801, -1020047062489810, 1196293929878069, 423965312676600, 731399806136310, 1253656937485679, -1152586335479235, -533828899023070, 126709155216156, 
-669483161404154, 639767667936847, 390312195926872, -785183749412471, -1071753966402934, 778344652917587, 4550508931469, 1189395121888154, 582172785646311, -743772858311951, -85114160153043, -307146261316702, -1395141504624193, -837696972399379, 347409513985611, 106994239964238, 863283119313838, 2105595508167494, -185568267040842, -1291589868990436, -119557282821937, -835812795247771, -136707916056218, -39354034862519, -999735017943848, 555226341134670, 773800335978731, -839191412199311, -722105303029718, -991451207281012, 
521036644955806, -575665637833397, -527891791855944, 921792178427885, -48109680587982, 198691369029471, -1594569873723135, -612300341564286, -128277806892477, 665449650280693, 603939220406305, -1191917375930710, 131802968554107, -588176179181087, -549925878582217, 252062340259078, -238548303461914, 324565198206430, -124345554733042, 244405417017228, 1605881874598347, -222019698833351, -116531455394690, 2098660023211949, -641354839833032, 381560428158470, -1863447632019113, 202058079118453, 1332686655795026, -74238036550724, 
-1201117603984234, 334378782179127, 2208275593017240, 1587819380355297, -838944157527942, -472560572043621, 854765781674821, -1402395172934902, 167422516467215, 229703661676553, 658688332889829, 887335124647890, 745511381349671, -171665921400923, -1084845229642541, -686702170073442, 272481402799870, -1562784969844522, 753515904028614, -215277359830852, -1198879855970889, 1975613189242205, 511513504981494, 196643560529825, -1229673224258280, 329376562453406, -982526813538701, 229822128439689, -986125326840550, 389799637737900, 
-1002668798834578, -1241826538560557, -347676505109512, -525166581161307, -228400944468766, 1672909032538567, -638442776741991, -911485614688846, -915175355491317, -766295749906323, 693212088582585, -812866418671718, -482636591837821, 651686001055097, -2237748013345, -1075927482635114, -1118554238896522, 605855741072814, 1599636294485086, 443548885377708, -933491682864045, -927580399245295, -347052059751602, -282163359138715, 1320668403107704, -542764637108842, -9102613811457, -544294549532691, 578552787698690, -2378059523548324, 
-408449735525978, 292937112299999, 38579910216152, 149926177154169, -686509987085078, -155380743474013, 430075594998333, 106502883263738, 136422861463799, 460087562619745, -222321468212003, 542448296747138, 1605059169470031, 603764479299485, -69177115970533, -256072865355666, 140503755493838, 710762678668262, 1344840674492758, -223556875165604, 39004825631839, 1114621807780501, 1230928784687110, 943447179580729, -1034834535656616, 505976161723758, 771440710808763, 1420502073198817, 744523750441098, -598316125927476, 
-270666524602946, 518632951288603, 210801236391736, 308405347162781, 144845113847570, 1072706042499567, -1155021205391247, 627020424860514, 465158926597267, -1326545302223067, 1511976019035537, -465329224683766, -496667104617141, 516259531068241, -447454561157817, -917614983751258, -245296951574394, 567243711871230, 1396459986141230, 745941881086156, 255983796883355, -783474355158999, 439077253170590, -558136644977059, -229743351003464, -106863842227546, -344903658297241, -170582022333787, -32738122350286, -391368119623172, 
701855462983734, 2308513534285895, 1567783352447512, -519587761747375, 31818553867226, -1392196336812181, -224699299672971, 1243798904579434, 1887958640874911, 1160805167201017, -81164530035179, 1313610327591346, -1740670707747017, -1092653212038443, -526650321486301, -264766962029122, -654961574139874, 1244431357751414, 1381068361564262, 214931402530556, -1051660827810105, -181875576590067, 1726533742139286, 902663030713617, -1174771247800424, 470741115953854, -425313607295549, -794299621835655, 439796344954490, -583505441124116, 
-194204459066738, -456979845200605, -1487759777132424, -430770193654315, -2330557087539774, 1113183580563927, -502331305719415, 508753776144786, 103713069030875, 1807155440053021, -1320021292621399, -873468561544966, 1305447703821267, 1303755510421865, 1753516290793839, 1487269205534774, 1282266020422678, 975229709382606, 1759974982950782, 530887579828716, 57047706807715, -315429308549503, 1172659355189102, -199861716485227, 981251518206968, -304667210796746, 439914949584783, -121336206634339, 849791887831778, -961023915829348, 
-136503812973498, 375640569037935, -1009736500330408, -734667868129175, 561778590183754, -921094963502861, 244865661712365, 585891281987674, 867934972722695, 18627441933521, 631544872319117, 1432778970744674, -569050197696033, -1390665194127539, -251252165874453, 713357899201166, 635845386460654, 5935916362374, -90163341455114, 886384144927900, -644959629119761, 605848638924485, 986201874402470, -874337900397271, 809923023286744, -948182079035506, 380789481214859, 1351958235062865, 1463446342410986, -318875904801524, 
735383317930718, -398646915949589, -478508664199240, -68486799484339, 1386120201807090, -1346118304619649, -276168599973663, -885232621609918, -1279069730770461, 699498239638101, -57586684478463, -16057815733910, 27751782394651, -2135522579116607, 508455816146263, 760849066163270, -616455935097562, -1302589367010786, -2026104289855922, -163471667229172, -327856622628757, -206089004728039, 861333831773374, 308872946065933, 807424236715832, -315007146386106, 74264717809271, 32316991804885, 2073361265804562, 648989558989884, 
1662997935421910, 879499475048535, -632048618126184, 770738191733953, -199326005788358, -861060502643909, -321224389885275, 2044044827986378, 148617731396655, 183273591498473, 727832460763717, 709880431953298, -1387920476663737, 84209697172229, 1063239940559475, 253204630029022, -1102592762190018, 1080854418030102, 646330218501894, -687883978845892, -581600118456617, 462377658225085, -829769861897418, 1600970635389825, 445213121157656, 108472362411998, 253606854862867, -263452252598167, -1925048487450150, 1896097414687788, 
-165752894260562, 136015016716659, 860246313078008, 199735473147397, -509117918801758, 181100085381351, -809561388465031, -58416439148686, -372260647085397, -1693914423582003, -177767316911463, -1697626931491750, -206333768131293, -203371209529767, 2244598053878527, -1243564241692202, 5770338559926, 572397956931566, -612083204507490, -1784344269255380, 788045797722611, -1455743336815119, -1039762613526130, -619527996166203, -376270428333960, 149345117082326, 702363667795743, 841529688904269, -118544741137470, 772809370152924};

float invG2[30 * 30] = {
-2.22044604925031e-16, 3.33066907387547e-16, -2.22044604925031e-16, -6.66133814775094e-16, 4.44089209850063e-16, -2.22044604925031e-16, -4.44089209850063e-16, -1.11022302462516e-16, 4.44089209850063e-16, 0.000000000000000, 2.22044604925031e-16, -1.11022302462516e-16, -5.55111512312578e-16, -2.22044604925031e-16, -1.22124532708767e-15, -5.55111512312578e-16, 4.44089209850063e-16, 2.22044604925031e-16, -2.22044604925031e-16, 2.22044604925031e-16, 1.11022302462516e-16, 7.77156117237610e-16, 0.000000000000000, -6.66133814775094e-16, 7.77156117237610e-16, 3.33066907387547e-16, 4.44089209850063e-16, 1.11022302462516e-16, 3.33066907387547e-16, 6.66133814775094e-16, 
1.11022302462516e-16, -2.22044604925031e-16, 6.66133814775094e-16, 8.88178419700125e-16, -9.99200722162641e-16, 0.000000000000000, 4.44089209850063e-16, 0.000000000000000, -5.55111512312578e-16, -6.66133814775094e-16, -3.33066907387547e-16, 1.11022302462516e-16, 5.55111512312578e-16, 5.55111512312578e-16, 1.55431223447522e-15, 4.44089209850063e-16, -4.44089209850063e-16, 2.22044604925031e-16, -1.11022302462516e-16, -4.44089209850063e-16, -2.22044604925031e-16, -9.99200722162641e-16, -2.22044604925031e-16, 7.77156117237610e-16, -7.77156117237610e-16, 0.000000000000000, -8.88178419700125e-16, -2.22044604925031e-16, -6.66133814775094e-16, -7.77156117237610e-16, 
1.11022302462516e-16, 0.000000000000000, -4.44089209850063e-16, -7.77156117237610e-16, 4.44089209850063e-16, -2.22044604925031e-16, -4.44089209850063e-16, -2.22044604925031e-16, 3.33066907387547e-16, 3.33066907387547e-16, 2.22044604925031e-16, -1.11022302462516e-16, -4.44089209850063e-16, -4.44089209850063e-16, -8.88178419700125e-16, -4.44089209850063e-16, 5.55111512312578e-16, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 4.44089209850063e-16, 3.33066907387547e-16, -2.22044604925031e-16, 6.66133814775094e-16, 2.22044604925031e-16, 3.33066907387547e-16, 2.22044604925031e-16, 1.11022302462516e-16, 5.55111512312578e-16, 
5.55111512312578e-16, -1.11022302462516e-16, 9.99200722162641e-16, 9.99200722162641e-16, -8.88178419700125e-16, 4.44089209850063e-16, 3.33066907387547e-16, 0.000000000000000, -3.33066907387547e-16, -5.55111512312578e-16, 1.11022302462516e-16, -2.22044604925031e-16, 3.33066907387547e-16, 6.66133814775094e-16, 1.33226762955019e-15, 1.11022302462516e-16, -7.77156117237610e-16, 3.33066907387547e-16, -2.22044604925031e-16, -5.55111512312578e-16, 1.11022302462516e-16, -1.11022302462516e-15, -5.55111512312578e-16, 7.77156117237610e-16, -7.77156117237610e-16, 3.33066907387547e-16, -1.33226762955019e-15, 0.000000000000000, -5.55111512312578e-16, -7.77156117237610e-16, 
5.55111512312578e-16, -1.11022302462516e-16, 5.55111512312578e-16, 5.55111512312578e-16, -2.22044604925031e-16, 1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, -3.33066907387547e-16, -2.22044604925031e-16, 1.11022302462516e-16, -2.22044604925031e-16, 2.22044604925031e-16, 2.22044604925031e-16, 8.88178419700125e-16, -1.11022302462516e-16, -4.44089209850063e-16, 2.22044604925031e-16, -1.11022302462516e-16, -5.55111512312578e-16, -1.11022302462516e-16, -8.88178419700125e-16, -1.11022302462516e-16, 6.66133814775094e-16, -4.44089209850063e-16, 0.000000000000000, -1.11022302462516e-15, 3.33066907387547e-16, -4.44089209850063e-16, -5.55111512312578e-16, 
2.22044604925031e-16, 0.000000000000000, 3.33066907387547e-16, 1.11022302462516e-16, -2.22044604925031e-16, -3.33066907387547e-16, 0.000000000000000, -2.22044604925031e-16, -4.44089209850063e-16, -2.22044604925031e-16, 1.11022302462516e-16, -3.33066907387547e-16, 1.11022302462516e-16, 1.11022302462516e-16, 3.33066907387547e-16, -1.11022302462516e-16, 0.000000000000000, 2.22044604925031e-16, 1.11022302462516e-16, -3.33066907387547e-16, 0.000000000000000, -3.33066907387547e-16, 0.000000000000000, 3.33066907387547e-16, -1.11022302462516e-16, 0.000000000000000, -6.66133814775094e-16, 2.22044604925031e-16, -4.44089209850063e-16, -2.22044604925031e-16, 
6.66133814775094e-16, -2.22044604925031e-16, 5.55111512312578e-16, 4.44089209850063e-16, -4.44089209850063e-16, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 3.33066907387547e-16, -4.44089209850063e-16, -1.11022302462516e-16, 1.11022302462516e-16, 5.55111512312578e-16, -4.44089209850063e-16, -5.55111512312578e-16, 2.22044604925031e-16, 0.000000000000000, -3.33066907387547e-16, 1.11022302462516e-16, -8.88178419700125e-16, -4.44089209850063e-16, 6.66133814775094e-16, -3.33066907387547e-16, 5.55111512312578e-16, -1.11022302462516e-15, 4.44089209850063e-16, -3.33066907387547e-16, -5.55111512312578e-16, 
1.11022302462516e-16, 0.000000000000000, -5.55111512312578e-16, -5.55111512312578e-16, 4.44089209850063e-16, -2.22044604925031e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 5.55111512312578e-16, 1.11022302462516e-16, -2.22044604925031e-16, -4.44089209850063e-16, -2.22044604925031e-16, -7.77156117237610e-16, 0.000000000000000, 2.22044604925031e-16, -2.22044604925031e-16, 2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 4.44089209850063e-16, 4.44089209850063e-16, 1.11022302462516e-16, 3.33066907387547e-16, -2.22044604925031e-16, 4.44089209850063e-16, 3.33066907387547e-16, 3.33066907387547e-16, 2.22044604925031e-16, 
1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, 2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, -2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, 2.22044604925031e-16, 0.000000000000000, -3.33066907387547e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, -3.33066907387547e-16, -3.33066907387547e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 
1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, -1.11022302462516e-16, 3.33066907387547e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.22044604925031e-16, -2.22044604925031e-16, 2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 
-1.11022302462516e-16, 1.11022302462516e-16, -4.44089209850063e-16, -4.44089209850063e-16, 4.44089209850063e-16, -1.11022302462516e-16, -2.22044604925031e-16, -1.11022302462516e-16, 2.22044604925031e-16, 2.22044604925031e-16, 2.22044604925031e-16, 1.11022302462516e-16, -2.22044604925031e-16, -4.44089209850063e-16, -6.66133814775094e-16, -3.33066907387547e-16, 3.33066907387547e-16, 0.000000000000000, 2.22044604925031e-16, 2.22044604925031e-16, 1.11022302462516e-16, 3.33066907387547e-16, 2.22044604925031e-16, -1.11022302462516e-16, 3.33066907387547e-16, 1.11022302462516e-16, 4.44089209850063e-16, 2.22044604925031e-16, 3.33066907387547e-16, 3.33066907387547e-16, 
-3.33066907387547e-16, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, -3.33066907387547e-16, -4.44089209850063e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 2.22044604925031e-16, -2.22044604925031e-16, 3.33066907387547e-16, 2.22044604925031e-16, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, -2.22044604925031e-16, 5.55111512312578e-16, 2.22044604925031e-16, -5.55111512312578e-16, 2.22044604925031e-16, -5.55111512312578e-16, 4.44089209850063e-16, -4.44089209850063e-16, -1.11022302462516e-16, 1.11022302462516e-16, 
0.000000000000000, 2.22044604925031e-16, -4.44089209850063e-16, -2.22044604925031e-16, 5.55111512312578e-16, -2.22044604925031e-16, 2.22044604925031e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, -5.55111512312578e-16, 3.33066907387547e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 2.22044604925031e-16, 4.44089209850063e-16, 4.44089209850063e-16, -1.11022302462516e-16, 2.22044604925031e-16, -5.55111512312578e-16, 3.33066907387547e-16, 2.22044604925031e-16, 2.22044604925031e-16, 2.22044604925031e-16, 
-2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, 2.22044604925031e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -4.44089209850063e-16, -1.11022302462516e-16, -1.11022302462516e-16, 
2.22044604925031e-16, -1.11022302462516e-16, 2.22044604925031e-16, 2.22044604925031e-16, -2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, 3.33066907387547e-16, -1.11022302462516e-16, -2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, -2.22044604925031e-16, 0.000000000000000, -3.33066907387547e-16, -2.22044604925031e-16, 3.33066907387547e-16, -1.11022302462516e-16, 3.33066907387547e-16, -5.55111512312578e-16, 3.33066907387547e-16, -1.11022302462516e-16, -1.11022302462516e-16, 
1.11022302462516e-16, -2.22044604925031e-16, 2.22044604925031e-16, 1.11022302462516e-16, -3.33066907387547e-16, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 4.44089209850063e-16, -2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, -5.55111512312578e-16, -1.11022302462516e-16, 4.44089209850063e-16, -3.33066907387547e-16, 5.55111512312578e-16, -4.44089209850063e-16, 1.11022302462516e-16, -1.11022302462516e-16, -3.33066907387547e-16, 
0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, -2.22044604925031e-16, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, 3.33066907387547e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, -2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 
2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, 3.33066907387547e-16, 1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 2.22044604925031e-16, 1.11022302462516e-16, -2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 
1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, -3.33066907387547e-16, -1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, -2.22044604925031e-16, 2.22044604925031e-16, 0.000000000000000, 3.33066907387547e-16, -2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 
1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -2.22044604925031e-16, 3.33066907387547e-16, 0.000000000000000, 3.33066907387547e-16, -1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, -1.11022302462516e-16, 
1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -2.22044604925031e-16, 0.000000000000000, -2.22044604925031e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, -3.33066907387547e-16, 2.22044604925031e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, -3.33066907387547e-16, -2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 3.33066907387547e-16, -1.11022302462516e-16, -1.11022302462516e-16, -2.22044604925031e-16, 0.000000000000000, 
-1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -3.33066907387547e-16, -1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, -2.22044604925031e-16, 2.22044604925031e-16, 0.000000000000000, -2.22044604925031e-16, 0.000000000000000, -2.22044604925031e-16, 2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 3.33066907387547e-16, 2.22044604925031e-16, 1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 
1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 
1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, -3.33066907387547e-16, 0.000000000000000, -1.11022302462516e-16, -2.22044604925031e-16, 
2.22044604925031e-16, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, 2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, -2.22044604925031e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, -2.22044604925031e-16, -1.11022302462516e-16, 
-1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 2.22044604925031e-16, -2.22044604925031e-16, 3.33066907387547e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 2.22044604925031e-16, 1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 
-1.11022302462516e-16, 1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -2.22044604925031e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 2.22044604925031e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, -2.22044604925031e-16, 1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 3.33066907387547e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, 
1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 3.33066907387547e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 
-1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, -2.22044604925031e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 2.22044604925031e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, -1.11022302462516e-16, 1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, 0.000000000000000, 
-1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 2.22044604925031e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, 0.000000000000000, 2.22044604925031e-16, 0.000000000000000, -1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 0.000000000000000, -1.11022302462516e-16, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16, -1.11022302462516e-16, 0.000000000000000, 0.000000000000000, 0.000000000000000, -2.22044604925031e-16, 2.22044604925031e-16, 0.000000000000000, 1.11022302462516e-16, 1.11022302462516e-16 };


unsigned long long Greduite[16] =
{-186304953996472, -216211368070119,  110964501361298,  131252974561432,
-126056243766680,   99587582169277,   -5646098666150, -233919070109448,
   7937589136904, -214303762177807, -268280113597118,  -98716819647784,
  93078431381544,   -1707551230219,  149382085707466, -134620659538888}; 

float invG[16] =
{-2.04279952328856e-15, -2.93791683689260e-15,  6.74861642263602e-16,  2.61840245666112e-15,
-1.98886046520741e-15,  1.10621147658696e-15, -2.12731308263381e-15, -2.30132753131773e-15,
 1.44762674070265e-15, -1.54769860122306e-16, -1.55490854567009e-15,  2.82055195172104e-15,
 2.19171469167945e-16, -2.21708502251561e-15, -1.23181629826941e-15, -2.45886210697988e-15};


void init_var_globales(){
    //multiplier a OK !
    a = (((pcg128_t) 2549297995355413924) << k) + ((pcg128_t) 4865540595714422341);
    
    //increment c OK !
    c = (((pcg128_t)6364136223846793005) << k) + 1442695040888963407;
    
    //nombre de threads 
    nb_thread = omp_get_max_threads();
    
    //increment polynome polC OK !
    polA[0] = 0;
    powA[0] = 1;
    for(int i = 1; i < nboutput ; i++){
        polA[i] = polA[i-1] + powA [i-1];
        powA[i] = powA[i-1] * a;
    }
    for(int i = 0; i < nboutput ; i++){
        lowPolA[i] = polA[i];
        lowPowA[i] = powA[i];
        YZPowA[i] = powA[i] >> known_low;
        YZPolA[i] = polA[i] >> known_low;
    }
}


//////////////////// chrono //////////////////
double wtime()
{
    struct timeval ts;
    gettimeofday(&ts, NULL);
    return (double) ts.tv_sec + ts.tv_usec / 1e6;
}


////////////////Fonctions calcul matriciel//////////////

//Matrice avce coeffs négatifs mais résult mod 2**64 (je sais pas si ça marche)
void prodMatVecU(unsigned long long* res, unsigned long long * M, unsigned long long* v, int n){
    int i, j;
    for(i=0 ; i<n ; i++){
        res[i] = 0;
        for(j=0 ; j<n ; j++)
            res[i]+= M[i * n + j] * v[j];
    }
}

void prodMatVecFFU(float* res, float* M, unsigned long long* v, int n){
    int i, j;
    for(i=0 ; i<n ; i++){
        res[i] = 0;
        for(j=0 ; j<n ; j++)
            res[i]+= M[i * n + j] * v[j];
    }
}

void prodMatMatU(unsigned long long* res, unsigned long long* M1, unsigned long long* M2, int n){//juste pour verif
    int i, j, l;
    for(i=0 ; i<n ; i++){
        for(j=0 ; j<n ; j++){
            res[i * + j] = 0;
            for(l=0; l<n ; l++)
                res[i * n + j]+= M1[i * n + l] * M2[l * n + j];
        }
    }
}




////////////////Fonctions pour la récupération de S//////////////


void rotateX(unsigned long long* rX, unsigned long long* X,int* rot){ //pas verifié, repris de pcg_random
    for(int i = 0 ; i < nbiter ; i++)
        rX[i]= (X[i] >> rot[i]) | (X[i] << ((- rot[i]) & (k-1)));
}

void unrotateX(unsigned long long* urX, unsigned long long* X, int* rot){//pas verifié, repris de pcg_random
    int rot2[nbiter];
    for( int i = 0 ; i < nbiter ; i++)
        rot2[i] = (k - rot[i]) % k;
    rotateX(urX, X, rot2);
}

unsigned long long unrotate1(unsigned long long Xi){
    return (Xi >> (k-1)) | (Xi << 1);
}

/*void getPolW(pcg128_t *polW, unsigned long long W0){ //OK !
    polW[0] = W0;
    for(int i = 1 ; i < nbiter ; i++){
        polW[i] = polW[i-1] * a;
    }
}*/

/*void getSumPol(unsigned long long* sumPol,unsigned long long* sumPolY, pcg128_t* polW){
    pcg128_t sum;
    for(int i = 0 ; i < nbiter ; i++){
        sum = polC[i] + polW[i];
        sumPol[i] = sum;
        sumPolY[i] = (sum >> (k - known_up)) % (1 << (known_low + known_up));
    }
}*/

void getY(unsigned long long *Y, unsigned long long W0, unsigned long long WC, int* rot, unsigned long long* uX){
    for(int i = 0 ; i < nbiter ; i++){
        Y[i] = ((((unsigned long long) ((polA[i] * WC + powA[i] * W0) % (1 << known_low))) ^ (uX[i] % (1 << known_low))) << known_up) + (rot[i] ^ (uX[i] >> (k - known_up)));
    }
}

void getYprim(unsigned long long *Yprim, unsigned long long *Y, unsigned long long W0, unsigned long long WC){
    for(int i = 0 ; i < nbiter ; i++)
        Yprim[i] = (unsigned long long) (Y[i] - ((polA[i] * WC + powA[i] * W0) >> (k - known_up))) % (1<<(known_up + known_low));
}

void getDY(unsigned long long *DY, unsigned long long* Yprim){
    for(int i = 0 ; i < nbiter - 1 ; i++)
        DY[i] = (Yprim[i+1] - Yprim[i]) % (1<<(known_low + known_up));
}

void getDS64(pcg128_t* DS64, pcg128_t* S,unsigned long long W0,unsigned long long WC){
    for(int i = 0 ; i < nboutput - 1 ; i++)  
        DS64[i] = (S[i+1] - S[i] - powA[i] * WC - (powA[i+1] - powA[i]) * W0) % (((pcg128_t) 1) << (k + known_low));
}

void getDSmod(pcg128_t* DSmod, unsigned long long* DS64, unsigned long long W0, unsigned long long WC){
    for(int i = 0 ; i < nbiter - 1 ; i++)  
        DSmod[i] = ((((pcg128_t) DS64[i]) << known_low) + powA[i] * WC + (powA[i+1] - powA[i]) * W0) % (((pcg128_t) 1) << (k + known_low));
}

void FindDS64(unsigned long long* DS64,unsigned long long* uX,int* rot,unsigned long long W0,unsigned long long WC){
    unsigned long long Y[nbiter];
    getY(Y, W0, WC, rot, uX);
    
    unsigned long long Yprim[nbiter];
    getYprim(Yprim, Y, W0,WC);
    
    
    unsigned long long tmp[nbiter-1];
    getDY(tmp, Yprim);
    
    for(int i = 0 ; i < nbiter - 1 ; i++)
        tmp[i] = tmp[i] << (k - known_up - known_low);
    float u[nbiter-1];
    prodMatVecFFU(u, invG, tmp, nbiter-1);
    for(int i = 0 ; i < nbiter-1 ; i++)
        tmp[i] = (unsigned long long) llroundf(u[i]);
    prodMatVecU(DS64, Greduite, tmp, nbiter-1);
}
    
int FindRoti(int *roti, unsigned long long DS640, unsigned long long Xi,int  i,unsigned long long Y0,unsigned long long W0,unsigned long long WC){//OK !
    unsigned long long tmp = polA[i] * DS640;
    tmp += W0 * ((unsigned long long) (powA[i] >> known_low) - 1) + WC * ((unsigned long long) (polA[i] >> known_low) - 1);
    unsigned long long Yi1 = (Y0 + (tmp >> (k - known_low - known_up))) % (1<< (known_low + known_up)); //avec ou sans retenue OK!
    unsigned long long Yi2 = Yi1 + 1;
    unsigned long long Wi = (W0 * ((unsigned long long) powA[i]) + WC * ((unsigned long long) polA[i])) % (1<< known_low);
    int test1, test2,cptRot = 0;
    for(int i = 0 ; i < k ; i++){
        test1 = (((Xi ^ (Yi1 >> known_up)) % (1 << known_low)) == Wi) && ((i ^ (Xi >> (k - known_up))) == Yi1 % (1 << known_up));
        test2 = (((Xi ^ (Yi2 >> known_up)) % (1 << known_low)) == Wi) && ((i ^ (Xi >> (k - known_up))) == Yi2 % (1 << known_up));
        if (test1 || test2){
            roti[cptRot] = i;
            cptRot++;
        }
        Xi = unrotate1(Xi);
    }
    return cptRot;
}

int FindRot(int *rot, int* nbrot, unsigned long long DS640,unsigned long long* X,unsigned long long Y0,unsigned long long W0,unsigned long long WC,int n){
    for(int i = 0 ; i < n ; i++){
        nbrot[i] = FindRoti(rot + i * k, DS640, X[i], i, Y0, W0, WC);
        if(nbrot[i] == 0)
            return 0;
    }
    return 1;
}


void FindRotDS(int* rotDS, int* rot, unsigned long long DS640, unsigned long long W0, unsigned long long WC){//cohérent
    int tmp;
    for(int i = 0 ; i < nboutput-1 ; i++){
        tmp = rot[i+1] - rot[i];
        rotDS[i] = tmp - ((int) ((((powA[i] * DS640) << known_low) + WC * powA[i] + W0 * (powA[i+1] - powA[i])) >> (2 * k - known_up)));
        //printf("rotDS[%d] = %d\n", i, rotDS[i]);
    }
}

void FindUpDS(unsigned long long* upDS, int* rotDS){
    unsigned long long tmp[nboutput - 1];
    for(int i = 0 ; i < nbiter ; i++)
        tmp[i] = ((unsigned long long) rotDS[i]) << (k - known_low - known_up);
    float tmp2[nboutput - 1];
    prodMatVecFFU(tmp2, invG2, tmp, nboutput - 1);
    for(int i = 0 ; i < nbiter ; i++)
        tmp[i] = (unsigned long long) llroundf(tmp2[i]);
    prodMatVecU(upDS, Greduite2, tmp, nboutput - 1);
}

void FindDS(pcg128_t* DS, unsigned long long* upDS, unsigned long long DS640, unsigned long long W0,unsigned long long WC){
    for(int i = 0 ; i < nboutput - 1 ; i++)
        DS[i] = (((pcg128_t) upDS[i]) << (k + known_low)) + ((powA[i] * DS640) << known_low) + WC * powA[i] + W0 * (powA[i+1] - powA[i]);
}


void pcg(pcg128_t *S, unsigned long long* X, pcg128_t S0, pcg128_t C, int n)
{
    struct pcg_state_128 rng;
    pcg_oneseq_128_srandom_r(&rng, S0);
    for (int i = 0 ; i < n ; i++) {
        X[i] = pcg_output_xsl_rr_128_64(rng.state);
        S[i] = rng.state;
        pcg_oneseq_128_step_r(&rng);
    }
}            
/*void pcg(pcg128_t *S, unsigned long long* X, pcg128_t S0, pcg128_t C, int n)
{
    struct pcg_state_setseq_128 rng;
    pcg_setseq_128_srandom_r(&rng, S0, C);
    for (int i = 0 ; i < n ; i++) {
        X[i] = pcg_output_xsl_rr_128_64(rng.state);
        S[i] = rng.state;
        pcg_setseq_128_step_r(&rng);
    }
}*/
